'''Unit tests for longtail.accuracy'''

import unittest, datetime
from longtail.accuracy import test_accuracy, speed_tests, print_results

class AccuracyTests(unittest.TestCase):

	"""Our UnitTest class."""

	physical = [{'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': '76                  MENLO PARK      CAUS'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'A & S 76        710 WILLOW RD          MENLO PARK   CAUS'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': '7-ELEVEN 03/10 #000101978 PURCHASE 1430 FRUITDALE AV SAN JOSE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': '7-ELEVEN 02/03 #000186601 PURCHASE 1430 FRUITDALE AV SAN JOSE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 01/31 #000311596 PURCHASE 470 RALSTON AVE BELMONT CA'}, {'factual_id': '139693831', 'BUSINESSSTANDARDNAME': 'City of Mountain View Shoreline Amphitheatre At Mountain View', 'DESCRIPTION': 'ARAMARK SHORELINE A MOUNTAIN VIEW   CAUS'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 01/22 #000490226 PURCHASE 470 RALSTON AVE BELMONT CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 04/05 #000079544 PURCHASE 1040 SUNNYVALE - SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 02/16 #000888874 PURCHASE 1040 SUNNYVALE - SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 05/31 #000753861 PURCHASE 1040 SUNNYVALE - SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 08/22 #000589150 PURCHASE 1040 SUNNYVALE - SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'AM VALERO FOOD 08/16 #000099854 PURCHASE 1502 E YOSEMITE A MADERA CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 09/03 #000802492 PURCHASE 470 RALSTON AVE BELMONT CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'ARCO PAYPOINT 10/02 #000577272 PURCHASE 1040 SUNNYVALE - SUNNYVALE CA'}, {'factual_id': '14738437', 'BUSINESSSTANDARDNAME': 'Arco Howard', 'DESCRIPTION': 'ARCO PAYPOINT 11/27 #000503476 PURCHASE ARCO PAYPOINT SUNNYVALE CA'}, {'factual_id': '4690027', 'BUSINESSSTANDARDNAME': 'Charter School of Morgan Hill', 'DESCRIPTION': 'ARCO PAYPOINT 06/08 #000431971 PURCHASE 18605 MONTEREY RD MORGAN HILL CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BALOMPIE CAFE RESTA SAN FRANCISCO   CAUS'}, {'factual_id': '4690027', 'BUSINESSSTANDARDNAME': 'Charter School of Morgan Hill', 'DESCRIPTION': 'ARCO PAYPOINT 06/08 #000915386 PURCHASE 18605 MONTEREY RD MORGAN HILL CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART MILLBRAE STAT  5104646979      CAUS'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART 16TH ST MI 2000 MISSION STREET    SAN FRANCISCOCAUS'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART SAN BRUNO 08/01 #000266625 PURCHASE BART SAN BRUNO ST SAN BRUNO CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART SAN BRUNO 06/12 #000153033 PURCHASE BART SAN BRUNO ST SAN BRUNO CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART SAN BRUNO 12/02 #000007164 PURCHASE BART SAN BRUNO ST SAN BRUNO CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART SAN BRUNO 06/19 #000406956 PURCHASE BART SAN BRUNO ST SAN BRUNO CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART SAN BRUNO 01/21 #000149366 PURCHASE BART SAN BRUNO ST SAN BRUNO CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BART SAN BRUNO 08/13 #000190509 PURCHASE BART SAN BRUNO ST SAN BRUNO CA'}, {'factual_id': '684149472', 'BUSINESSSTANDARDNAME': 'El Camino Auto Sales', 'DESCRIPTION': 'BEVERAGES & MO 02/22 #000609042 PURCHASE 1247 W EL CAMINO SUNNYVALE CA'}, {'factual_id': '684149472', 'BUSINESSSTANDARDNAME': 'El Camino Auto Sales', 'DESCRIPTION': 'BEVERAGES & MO 01/31 #000570224 PURCHASE 1247 W EL CAMINO SUNNYVALE CA'}, {'factual_id': '684149472', 'BUSINESSSTANDARDNAME': 'El Camino Auto Sales', 'DESCRIPTION': 'BEVERAGES & MO 03/16 #000586110 PURCHASE 1247 W EL CAMINO SUNNYVALE CA'}, {'factual_id': '684149472', 'BUSINESSSTANDARDNAME': 'El Camino Auto Sales', 'DESCRIPTION': 'BEVERAGES & MO 09/05 #000640591 PURCHASE 1247 W EL CAMINO SUNNYVALE CA'}, {'factual_id': '684149472', 'BUSINESSSTANDARDNAME': 'El Camino Auto Sales', 'DESCRIPTION': 'BEVERAGES & MO 03/01 #000646355 PURCHASE 1247 W EL CAMINO SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BCF - 1600 SAR 06/02 #000065900 PURCHASE BCF - 1600 SARATO SAN JOSE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BIG 5 SPORTING 06/18 #000014839 PURCHASE BIG 5 SPORTING GO SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BIG 5 SPORTING 05/06 #000024778 PURCHASE BIG 5 SPORTING GO SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BEVERAGES & MO 11/07 #000886296 PURCHASE BEVERAGES & MOR SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BROOKSHIRE #13 06/27 #000554402 PURCHASE 7713 HWY 165 COLUMBIA LA'}, {'factual_id': '690535774', 'BUSINESSSTANDARDNAME': 'Cafe Zoe', 'DESCRIPTION': 'CAFE ZOE            MENLO PARK      CAUS'}, {'factual_id': '41532290', 'BUSINESSSTANDARDNAME': 'Benders Bar and Grill', 'DESCRIPTION': 'ATM Withdrawal BENDERS BAR     806 S VAN NESS AVE     SAN FRAN     CAUS'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'CENTURY THEATRES 42 UNION CITY      CAUS'}, {'factual_id': '2698597', 'BUSINESSSTANDARDNAME': 'Century Park 12 Theatres', 'DESCRIPTION': 'CENTURY THEATRES 48 REDWOOD CITY    CAUS'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BIG 5 SPTG GDS 02/20 #000462508 PURCHASE BIG 5 SPTG GDS-00 SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BKOFAMERICA ATM 01/18 #000001041 WITHDRWL SUNNYVALE MAIN SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BKOFAMERICA ATM 09/21 #000001290 WITHDRWL SUNNYVALE MAIN SUNNYVALE CA'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'BKOFAMERICA ATM 05/05 #000007074 WITHDRWL SUNNYVALE MAIN SUNNYVALE CA'}, {'factual_id': '41524214', 'BUSINESSSTANDARDNAME': 'Tlr', 'DESCRIPTION': 'CA TLR cash withdrawal from CHK 2290 Banking Ctr SUNNYVALE INDUSTRIAL...'}, {'factual_id': '', 'BUSINESSSTANDARDNAME': '', 'DESCRIPTION': 'CA TLR cash withdrawal from CHK 2290 Banking Ctr SUNNYVALE MAIN OFFICE...'}] 
	non_physical = ['"CHECKCARD 0120 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0221 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0321 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0420 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0426 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0520 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0621 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0720 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0820 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 0920 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 1020 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 1120 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 1220 24HOUR FITNESS USA,INC 800-432-6348 CA..."', '"CHECKCARD 1227 BCF-COQUITLAM,QUEEN OF VICTORIA BC 74500012362461680275931"', '"CHECKCARD 1227 BCF-COQUITLAM,QUEEN OF VICTORIA BC 74500012362461680275931..."', '"CONCUR DES:EXPENSE ID:C008N1RUX000 INDN:Key, Joe A. CO ID:1911608052 PPD..."', '"CONCUR DES:EXPENSE ID:C00A9UJCX006 INDN:Key, Joe A. CO ID:1911608052 PPD..."', '"H S B C 04/12 #000887347 WITHDRWL H S B C / JOSE AZUETA, FEE"', '"H S B C 04/12 #000887347 WITHDRWL H S B C / JOSE AZUETA, INTERNATIONAL..."', '"H S B C 04/12 #000887347 WITHDRWL H S B C / JOSE AZUETA,"', '"YODLEE.COM INC DES:DIRECT DEP ID:315018338477QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:475019277469QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:515046671679QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:516042312983QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:516042312984QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:517046621180QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:519046304065QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:569025025433QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:575027196035QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:588025780457QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:590017342045QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:612026847301QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:625043170387QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:636041888967QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:640025839973QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:640025839974QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:654038835037QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:669033410119QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:681023381652QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:689051101128QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:696048239467QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:703030941426QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:714044355791QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:715043619496QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:740017497838QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:740017497839QBC INDN:KEY,JOE A CO..."', '"YODLEE.COM INC DES:DIRECT DEP ID:793028169125QBC INDN:KEY,JOE A CO..."', '*SCOTIABANK IN 04/07 #000684996 WITHDRWL SCOTIABANK IN/ BCO INVERLAT', '*SCOTIABANK IN 04/07 #000685080 WITHDRWL SCOTIABANK IN/ BCO INVERLAT', '*SCOTIABANK IN 04/08 #000704407 WITHDRWL SCOTIABANK IN/ BCO INVERLAT', '7-ELEVEN        77 NEWELL RD           EAST PALO ALTCAUS', 'BKOFAMERICA ATM 04/07 #000008734 WITHDRWL LAX-TERMINAL 5 D LOS ANGELES...', 'BNP 10/24 #000766600 WITHDRWL >49740AGENCE P PARIS 09', 'CHASE 06/27 #000530159 WITHDRWL 2600 CYPRESS ST W MONROE LA']
	accuracy_results = test_accuracy(non_physical_trans=non_physical, result_list=physical)
	time_delta = datetime.datetime.now() + datetime.timedelta(seconds=-100)
	speed_results = speed_tests(time_delta, accuracy_results)

	def setUp(self):
		self.accuracy_results = test_accuracy(non_physical_trans=self.non_physical, result_list=self.physical)

	def test_precision(self):
		self.assertEqual(self.accuracy_results['precision'], 25)

	def test_total_processed(self):
		self.assertEqual(self.accuracy_results['total_processed'], 100)

	def test_total_physical(self):
		self.assertEqual(self.accuracy_results['total_physical'], 46)

	def test_total_non_physical(self):
		self.assertEqual(self.accuracy_results['total_non_physical'], 54)

	def test_binary_accuracy(self):
		self.assertEqual(self.accuracy_results['binary_accuracy'], 100)

	def test_total_recall(self):
		self.assertEqual(self.accuracy_results['total_recall'], 13)

	def test_total_recall_non_physical(self):
		self.assertEqual(self.accuracy_results['total_recall_non_physical'], 29)

	def test_time_taken(self):
		self.assertEqual(self.speed_results['time_delta'].seconds, 100)

	def test_time_per_transaction(self):
		self.assertEqual(self.speed_results['time_per_transaction'], 1)
	
	def test_transactions_per_minute(self):
		self.assertEqual(self.speed_results['transactions_per_minute'], 60)
		
if __name__ == '__main__':
	unittest.main()
